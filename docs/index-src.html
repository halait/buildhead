<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="icon" type="image/png" href="/images/icon.png">
	<link rel="stylesheet" href="/style.css">
	<title>Let's do it</title>
	<meta name="google-site-verification" content="cwxbdL28yMr8f7_njaJMntysc_h-TlQh71n8FualssU" />
	<meta name="description" content="A 2D physics based puzzle game, with a focus on user created content. Play now!">
</head>
{{ define _startSimBtn 
<svg class="startSimulationBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
	xmlns="http://www.w3.org/2000/svg">
	<title>Start Simulation</title>
	<polygon points="30 80, 30 20, 85 50" fill="#fff"></polygon>
</svg>
}}
{{ define _ccwWheelBtn <img class="ccwWheelCreatorBtn toolbarBtn" title="Counter Clockwise Wheel" src="/images/ccwWheel.png" width="80" height="80"> }}
{{ define _nWheelBtn <img class="nWheelCreatorBtn toolbarBtn" title="Neutral Wheel" src="/images/nWheel.png" width="80" height="80"> }}
{{ define _cwWheelBtn <img class="cwWheelCreatorBtn toolbarBtn" title="Clockwise Wheel" src="/images/cwWheel.png" width="80" height="80"> }}
{{ define _nRodBtn
<svg class="nRodCreatorBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
	xmlns="http://www.w3.org/2000/svg">
	<title>Non-Colliding Rod</title>
	<line x1="20" y1="20" x2="80" y2="80" fill="none" stroke="#0ff" stroke-width="18"></line>
	<circle cx="20" cy="20" fill="rgb(0, 0, 0)" r="9"></circle>
	<circle cx="20" cy="20" fill="rgb(255, 255, 255)" r="6"></circle>
	<circle cx="80" cy="80" fill="rgb(0, 0, 0)" r="9"></circle>
	<circle cx="80" cy="80" fill="rgb(255, 255, 255)" r="6"></circle>
</svg>
}}
{{ define _cRodBtn
<svg class="cRodCreatorBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
	xmlns="http://www.w3.org/2000/svg">
	<title>Colliding Rod</title>
	<line x1="20" y1="20" x2="80" y2="80" fill="none" stroke="rgb(200, 200, 200)" stroke-width="18"></line>
	<circle cx="20" cy="20" fill="rgb(0, 0, 0)" r="9"></circle>
	<circle cx="20" cy="20" fill="rgb(255, 255, 255)" r="6"></circle>
	<circle cx="80" cy="80" fill="rgb(0, 0, 0)" r="9"></circle>
	<circle cx="80" cy="80" fill="rgb(255, 255, 255)" r="6"></circle>
</svg>
}}
{{ define _moveBtn
<svg class="moveBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
	xmlns="http://www.w3.org/2000/svg">
	<title>Move Tool</title>
	<polygon points="50 10, 35 25, 65 25" fill="#aaa"></polygon>
	<polygon points="10 50, 25 35, 25 65" fill="#aaa"></polygon>
	<polygon points="50 90, 35 75, 65 75" fill="#aaa"></polygon>
	<polygon points="90 50, 75 35, 75 65" fill="#aaa"></polygon>
	<line x1="50" y1="20" x2="50" y2="80" stroke="#aaa" stroke-width="7"></line>
	<line x1="20" y1="50" x2="80" y2="50" stroke="#aaa" stroke-width="7"></line>
</svg>
}}
{{ define _removeBtn
<svg class="removeBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
	xmlns="http://www.w3.org/2000/svg">
	<title>Remove Tool</title>
	<line x1="20" y1="20" x2="80" y2="80" stroke="#f00" stroke-width="7"></line>
	<line x1="80" y1="20" x2="20" y2="80" stroke="#f00" stroke-width="7"></line>
</svg>
}}
{{ define _closeBtn
<svg class="closeBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" 
	xmlns="http://www.w3.org/2000/svg">
	<title>Close Button</title>
	<line x1="20" y1="20" x2="80" y2="80" stroke="#fff" stroke-width="7"></line>
	<line x1="80" y1="20" x2="20" y2="80" stroke="#fff" stroke-width="7"></line>
</svg>
}}
{{ define _customizeFormTopChunk
<form class="customProperties">
	<h4>Type: </h4>
	<label><input class="fixedType" name="typeRadio" type="radio">Fixed</label>
	<label><input class="movableType" name="typeRadio" type="radio" checked>Movable</label>
	<span class="customGroup">
		<h4>Group: </h4>
		<p>If type is fixed, then group will automatically be set to fixed.</p>
		<label><input class="coplanarGroup" name="groupRadio" type="radio" checked>Coplanar</label>
		<label><input class="nonCoplanarGroup" name="groupRadio" type="radio">Non-Coplanar</label>
	</span>
	<span class="customTarget">
		<h4>Target: </h4>
		<p>Group must be coplanar in order for object to be target.</p>
		<label><input class="target" name="targetRadio" type="radio">Yes</label>
		<label><input class="nonTarget" name="targetRadio" type="radio" checked>No</label>
	</span>
	<h4>Joinable: </h4>
	<label><input class="joinable" name="joinableRadio" type="radio">Yes</label>
	<label><input class="nonJoinable" name="joinableRadio" type="radio" checked>No</label>
}}
{{ define _customizeFormBottomChunk
	<h4>Density: </h4>
	<input class="density" type="number" step="0.0001" min="0" placeholder="If empty defaults to 30.0">
	<h4>Friction: </h4>
	<label>Static friction: <input class="staticFriction" type="number" step="0.0001" min="0"
			placeholder="If empty defaults to 0.8"></label><br>
	<label>Kinetic friction: <input class="kineticFriction" type="number" step="0.0001" min="0"
			placeholder="If empty defaults to 0.5"></label>
	<h4>Velocity Resistance: </h4>
	<label>Linear velocity resistance: <input class="linearResistance" type="number" step="0.001" min="0"
			placeholder="If empty defaults to 0.01"></label><br>
	<label>Rotational velocity resistance: <input class="rotationalResistance" type="number" step="0.001"
			min="0" placeholder="If empty defaults to 0.01"></label><br>
	<input class="submitBtn" type="submit" value="Apply">
</form>
}}
{{ define _rodCustomizeFormChunk
<span id="rodProperties">
	<h4>Width: </h4>
	<input id="width" type="number" step="0.00001" min="0" placeholder="If empty defaults to 0.05"><br>
</span>
}}
{{ define _wheelCustomizeFormChunk
<span id="circleProperties">
	<h4>Radius: </h4>
	<input id="radius" type="number" step="0.00001" min="0" placeholder="If empty defaults to 0.1">
	<h4>Motor Speed: </h4>
	<input id="motorSpeed" type="number" step="0.00001" placeholder="If empty then circle non-motorized">
	<h4>Max Motor Torque: </h4>
	<input id="maxMotorTorque" type="number" step="0.00001" min="0"
		placeholder="If empty then circle non-motorized"><br>
</span>
}}
<body>
  <div id="game">
		<header id='site-header'>
			<button id="header-menu-btn" aria-label="Open menu">
				<svg id='header-menu-svg' viewBox="0 0 150 100" xmlns="http://www.w3.org/2000/svg" stroke="#fff" stroke-width="16" alt="Main menu button">
					<line x1="0" y1="10" x2="150" y2="10"></line>
					<line x1="0" y1="50" x2="150" y2="50"></line>
					<line x1="0" y1="90" x2="150" y2="90"></line>
				</svg>
			</button>
			<a id='header-logo-a' href='/'><h1 id='logo'>Buildhead</h1></a>
			<nav class='header-nav'>
				<a class='header-nav-a' href='/listing/original'>Orginal Levels</a>
				<a class='header-nav-a' href='/listing/community'>Community Levels</a>
				<a class='header-nav-a' href='/sandbox'>Sandbox</a>
			</nav>
			<button id="accountBtn">Login</button>
		</header>
    <div id="sandboxToolbar" class="toolbar">
			_startSimBtn
			_ccwWheelBtn
			_nWheelBtn
			_cwWheelBtn
			<svg class="tWheelCreatorBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
				xmlns="http://www.w3.org/2000/svg">
				<title>Custom Wheel</title>
				<circle cx="50" cy="50" fill="rgb(255, 255, 255)" r="40"></circle>
			</svg>
			_nRodBtn
			_cRodBtn
			<svg class="gRodCreatorBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
				xmlns="http://www.w3.org/2000/svg">
				<title>Custom Rod</title>
				<line x1="20" y1="20" x2="80" y2="80" stroke="rgb(255, 255, 255)" stroke-width="10"></line>
			</svg>
			<svg class="polygonBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
				xmlns="http://www.w3.org/2000/svg">
				<title>Custom Polygon</title>
				<polygon points="50 20, 25 75, 75 75" fill="#fff"></polygon>
			</svg>
			_moveBtn
			_removeBtn
			<svg class="assemblyFieldCreatorBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
				xmlns="http://www.w3.org/2000/svg">
				<title>Edit Box</title>
				<rect x="18" y="25" height="45" width="65" fill="rgb(0, 128, 255)"></rect>
			</svg>
			<svg class="goalFieldCreatorBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
				xmlns="http://www.w3.org/2000/svg">
				<title>Goal Box</title>
				<rect x="18" y="25" height="45" width="65" fill="rgb(255, 128, 0)"></rect>
			</svg>
			<svg class="saveLevelBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
				xmlns="http://www.w3.org/2000/svg">
				<title>Save Level</title>
				<polygon points="25 25, 65 25, 75 35, 75 75, 25 75" fill="#039"></polygon>
				<rect x="32" y="25" width="28" height="20" fill="#999"></rect>
				<rect x="48" y="27" width="8" height="16" fill="#000"></rect>
			</svg>
		</div>

    <div id="assemblySceneBtnsDiv" class="toolbar">
			_startSimBtn
			_ccwWheelBtn
			_nWheelBtn
			_cwWheelBtn
			_nRodBtn
			_cRodBtn
			_moveBtn
			_removeBtn
		</div>
		
		<div id="simulationSceneBtnsDiv" class="toolbar">
			<svg class="stopSimulationBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100"  width="80" height="80" 
				xmlns="http://www.w3.org/2000/svg">
				<title>Stop Simulation</title>
				<polygon points="25 25, 75 25, 75 75, 25 75" fill="#fff"></polygon>
			</svg>
		</div>

		<div id="createPolygonToolbar" class="toolbar">
      <svg id="polygonDoneBtn" class="toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" width="80" height="80" 
				xmlns="http://www.w3.org/2000/svg">
				<title>Done</title>
				<polyline points="10 50, 30 70, 90 10" fill="none" stroke-width="8" stroke="#4f4"></polyline>
      </svg>
    </div>
		
		<canvas id="canvas"></canvas>
		<div id="level-info">Name - Author</div>

    <div id="menuUI" class="overlay">
			<div id="menu-nav">
				<a class='menu-nav-a' href='/listing/original'>Orginal Levels</a>
				<a class='menu-nav-a' href='/listing/community'>Community Levels</a>
				<a class='menu-nav-a' href='/sandbox'>Sandbox</a>
			</div>
		</div>
		
		<div id="levelBrowserUi" class="overlay">
			<div id="browser-container">
				<div id="filter-container">
					<label id="search-container">
						<input id="search-input" type="search" placeholder="Search">
						<svg id="search-btn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" 
						stroke-width="4" stroke="#fff" fill="none">
							<title>Search</title>
							<circle cx="66" cy="33" r="31" stroke-width="4"></circle>
							<line x1="44.08" y1="54.92" x2="11.08" y2="87.92" stroke-width="8"></line>
						</svg>
					</label>
					<label id="sort-by-container">
						SORT BY: 
						<select id="sort-by-select">
							<option value="dateCreated" selected>Upload Date</option>
							<option id="order-option" value="index">Order</option>
							<option value="rating">Likes</option>
							<option value="plays">Plays</option>
						</select>
					</label>
				</div>
				<div id="content-container">
					<table id="levelBrowser">
						<thead>
							<tr>
								<th>Name</th>
								<th>Author</th>
								<th>Upload Date</th>
								<th>Likes</th>
								<th>Plays</th>
							</tr>
						</thead>
						<tbody id="browser-content">
						</tbody>
					</table>
					<div id="load-more-btn" class="btn">Load More</div>
				</div>
			</div>
		</div>

		<!--
		<div id="loadingDiv" class="overlay">
			<svg id="strob" preserveAspectRatio="xMinYMin meet" viewBox="0 0 80 20" xmlns="http://www.w3.org/2000/svg">
				<circle cx="10" cy="10" r="10"></circle>
				<circle cx="40" cy="10" r="10"></circle>
				<circle cx="70" cy="10" r="10"></circle>
			</svg>
		</div>
	-->

		<div id="mode-ui" class="modal">
			_closeBtn
			<p class="modalHeader">Mode</p>
			<div id="play-btn" class="btn">Play</div>
			<div id="edit-btn" class="btn">Edit</div>
			<div id="delete-btn" class="btn">Delete</div>
		</div>

		<div id="tutorialUi" class="modal">
      <div id="tutorialImgDiv">
        <p id="tutImgLoadingMsg">Loading...</p>
				<img id="tutorialImg" alt="Unable to load tutorial, check your internet connection.">
			</div>
			<span id="tutorialShrinkBtn" class="btn">Hide</span>
			<span id="tutorialShowBtn" class="btn">Show</span>
    </div>

    <div id="save-ui" class="modal">
			_closeBtn
			<p id="save-header" class="modalHeader"></p>
			<form id="save-form">
				<label>Name<br><input id="name-input" type="text" required></label>
				<label>Tags (optional, space seperated keywords used for search, the name you enter above and your username will be added automatically)<br><input id="tag-input" type="text"></label>
				<input id="save-btn" class="btn" type="submit" value="Save">
			</form>
			<p id="save-info-p" class="message"></p>
		</div>

		<!--
    <div id="loadLevelUI" class="modal">
      <p class="modalHeader">Load Level</p>
      <input id="level-input" type="file" accept="application/json" />
      <p id="loadMessageP"></p><br>
		</div>
	-->

    <div id="message-div" class="modal">
			_closeBtn
      <p id="message-header" class="modalHeader"></p>
			<span id="message"></span>
			<div id="message-btn" class="btn"></div>
    </div>

    <div id="setCustomObroundPopup" class="modal">
			_closeBtn
			<p class="modalHeader">Custom Obround Properties</p>
			_customizeFormTopChunk
			_rodCustomizeFormChunk
			_customizeFormBottomChunk
    </div>

    <div id="setCustomCirclePopup" class="modal">
			_closeBtn
			<p class="modalHeader">Custom Circle Properties</p>
			_customizeFormTopChunk
			_wheelCustomizeFormChunk
			_customizeFormBottomChunk
    </div>
    
    <div id="createPolygonPopup" class="modal">
			_closeBtn
			<p class="modalHeader">Custom Polygon Properties</p>
			_customizeFormTopChunk
			_customizeFormBottomChunk
    </div>
    
    <div id="successSceneDiv" class="modal">
			_closeBtn
			<p class="modalHeader">Success</p>
			<div id="points-widget">
				<svg id="increment-btn" class="success-increment-btn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" fill="#0f0" stroke="#0f0">
					<title>Increment</title>
					<polygon points="50 10, 15 45, 42 45, 42 90, 58 90, 58 45, 85 45"></polygon>
				</svg>
				<div id="rating"></div>
				<svg id="decrement-btn" class="success-increment-btn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" fill="#f00" stroke="#f00">
					<title>Decrement</title>
					<polygon points="50 90, 15 55, 42 55, 42 10, 58 10, 58 55, 85 55"></polygon>
				</svg>
			</div>
			<!--<div id="next-level-btn" class="btn">Next</div>-->
			<div id="go-back-btn" class="btn">Go Back</div>
			<span id="solution-btns">
				<div id="save-solution-btn" class="btn">Save Solution</div>
				<div id="browse-solutions-btn" class="btn">Browse Solutions</div>
			</span>
			<div id="main-menu-btn" class="btn">Main Menu</div>
		</div>
		
		<div id="loginUi" class="modal">
			_closeBtn
			<p class="modalHeader">Login</p>
			<div id="login-message"></div>
			<form id="loginForm">
				<label>Email Address<br><input id="loginEmail" type="email" required></label><br><br>
				<label>Password<br><input id="loginPassword" type="password" required minlength="6" maxlength="128"></label>
				<span id="showPasswordBtn" class="smallBtn btn">Show Password</span><br>
				<p id="loginMessage" class="message errMessage"></p>
				<input id="loginBtn" class="btn" type="submit" value="Login">
			</form>
			<p class="message">Don't have an account?</p>
			<div id="registerBtn" class="btn">Create Account</div>
		</div>

    <div id="registerUi" class="modal">
			_closeBtn
			<p class="modalHeader">Create Account</p>
			<form id="registerForm">
				<label>Email<br><input id="registerEmail" type="email" required></label>
				<p id="registerEmailMessage" class="message errMessage"></p>
				<label>Username<br><input id="registerName" type="text" pattern="[\w@#\*\-\+\[\]\{\}/\.,~]+" required></label>
				<p id="registerNameMessage" class="message errMessage"></p>
				<label>Password<br><input id="registerPassword0" type="password" required minlength="6" maxlength="128"></label><br>
				<label>Confirm Password<br><input id="registerPassword1" type="password" required minlength="6" maxlength="128"></label>
				<p id="registerPasswordMessage" class="message errMessage"></p>
				<p class="message">The username and password cannot contain white <br>space, parentheses and other special characters</p>
				<span id="showPasswordsBtn" class="smallBtn btn">Show Password</span><br>
				<input class="btn" type="submit" value="Submit">
			</form>
		</div>

		<div id="profileUi" class="modal">
			_closeBtn
			<p class="modalHeader">Profile</p>
			<span id="logoutBtn" class="btn">Logout</span>
		</div>
	</div>

		<!--
		<svg class="backBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100"
			xmlns="http://www.w3.org/2000/svg">
			<title>Go Back</title>
			<line x1="10" y1="50" x2="90" y2="50" stroke="#fff" stroke-width="5"></line>
			<line x1="10" y1="50" x2="40" y2="20" stroke="#fff" stroke-width="5"></line>
			<line x1="10" y1="50" x2="40" y2="80" stroke="#fff" stroke-width="5"></line>
		</svg>
		<svg class="loadLevelBtn toolbarBtn" preserveAspectRatio="xMinYMin meet" viewBox="0 0 100 100"
			xmlns="http://www.w3.org/2000/svg">
			<title>Load Level</title>
			<rect x="20" y="30" width="60" height="40" fill="#dd0"></rect>
			<polygon points="30 35, 90 35, 80 70, 20 70" fill="#880"></polygon>
			<polygon points="44 32, 56 32, 56 22, 44 22" fill="#0f0"></polygon>
			<polygon points="40 22, 50 12, 60 22" fill="#0f0"></polygon>
		</svg>
		-->

	<script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-firestore.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-auth.js"></script>
	<script src="/scripts/event_manager.js"></script>
	<script src="/scripts/scenes.js"></script>
	<script src="/scripts/firebase.js"></script>
	<script src="/scripts/physics.js"></script>
	<script src="/scripts/helper.js"></script>
	<script src="/scripts/tick.js"></script>
	<script src="/scripts/modals.js"></script>
</body>
</html>